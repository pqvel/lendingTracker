const burger = ({
    burgerSelector,
    listSelector,
    activeBurgerStyle,
    activeListStle
}) => {
    const burger = document.querySelector(burgerSelector),
          list = document.querySelector(listSelector);

    burger.addEventListener('click', (e) => {
        if (burger.classList.contains(activeBurgerStyle)) {
            burger.classList.remove(activeBurgerStyle)
            list.classList.remove(activeListStle)
        } else {
            burger.classList.add(activeBurgerStyle)
            list.classList.add(activeListStle)
        }

    })
}

const checkbox = ({checkboxSelector, activeStyle}) => {
    // label>input

    const checkboxs = [...document.querySelectorAll(checkboxSelector)];

    checkboxs.forEach(item => {
        item.addEventListener('click', (e) => {
            checkboxs.forEach(checkbox => {
                if (e.target === checkbox) {
                    checkbox.classList.toggle(activeStyle)
                }
            })
        })
    })
}

const tabs = ({
    tabsParentSelector,
    itemsParentSelector,
    activeStyle,
    displayStyle = 'block'
    }) => {
    const items = [...document.querySelector(itemsParentSelector).children],
          tabs = [...document.querySelector(tabsParentSelector).children];

        const hideTabContent = () => {
        
            items.forEach(item => {
                item.style.display = 'none'
            });
    
            tabs.forEach(item => {
                item.classList.remove(activeStyle);
            });
        }
    
        const showTabContent = (i = 0) => {
            
            items[i].style.display = displayStyle;
            tabs[i].classList.add(activeStyle);
        }
        
        hideTabContent();
        showTabContent();
        tabs.forEach(tab => {
            tab.addEventListener('click', function(e) {
            
                tabs.forEach((item, i) => {
                    if (e.target == item) {
                        hideTabContent();
                        showTabContent(i);
                    }
                
                });
        });
        })
}

const slider = ({
    sliderSelector,
    sliderRowSelector,
    sliderItemsSelector,
    sliderDotsSelector,
    activeDotsClass
}) => {
    const slider = document.querySelector(sliderSelector),
          row = document.querySelector(sliderRowSelector),
          items = [...document.querySelectorAll(sliderItemsSelector)],
          dots = [...document.querySelectorAll(sliderDotsSelector)];

    let pageWidth = document.documentElement.scrollWidth;
    let itemWidth = items[0].offsetWidth;
    let rowWidth = (items.length * itemWidth) + (items.length - 1) * 30;
    let rowLeft = -((rowWidth / 2) - pageWidth/2);
    let sliderCounter = 0;
    rowPostion = ((itemWidth + 30) * sliderCounter);
    

      const setSliderSize = (rowPostionArg) => {
        
        pageWidth = document.documentElement.scrollWidth;
        itemWidth = items[0].offsetWidth;
        rowWidth = (items.length * itemWidth) + (items.length - 1) * 30;
        //rowPostion = ((itemWidth + 30) * sliderCounter);

        rowLeft = rowWidth/2 - pageWidth/2;

        if (rowPostion > (rowLeft)) {
          rowPostion = rowLeft
        }
        
        if (-rowPostion > rowLeft) {
          rowPostion = -rowLeft
        }
        
        console.log('---------')
        console.table({pageWidth,itemWidth, rowWidth, rowPostion, rowLeft, positionLeft: rowLeft + rowPostion, sliderCounter})
        
        row.style.width = rowWidth + 'px'
        row.style.left = -rowLeft + rowPostion + 'px';
      }
      
      
      const initSlider = () => {
        setSliderSize();
        dots.forEach(dot => {
            dot.addEventListener('click', (e) => {
                e.target.classList.add(activeDotsClass)
            })
        })



        document.querySelector('.right').addEventListener('click', (e) => {
          
          if (rowPostion < rowLeft) {
            // sliderCounter++
            rowPostion += itemWidth+30;

            setSliderSize()
          }

        })


        document.querySelector('.left').addEventListener('click', (e) => {
          

          if (-rowPostion < rowLeft) {
            // sliderCounter--
            rowPostion -= itemWidth+30
            
            setSliderSize()
          }

        })
      }
      initSlider();

    
      resizeWidthOnly(function() {
        setSliderSize();
      });


    // // функция чтения изменения ширины окна браузера
    function resizeWidthOnly (a,b) {  
      var c = [window.innerWidth];
      return onresize = function() {
        var d = window.innerWidth,
            e = c.length;
        c.push(d);
        if(c[e]!==c[e-1]){
          clearTimeout(b);
          b = setTimeout(a, 50);
        } 
      }, a;
    }


    const widthScroll = () => {
      const div = document.createElement('div');

      div.style.overflowY = 'scroll';
      div.style.width = '50px';
      div.style.height = '50px';

      document.body.append(div);
      let scrollWidth = div.offsetWidth - div.clientWidth;

      div.remove();

      return scrollWidth;
  }
}


document.addEventListener('DOMContentLoaded', (e) => {
    tabs({
        tabsParentSelector: '.tarif-plan__category-list',
        itemsParentSelector: '.tarif-plan__items',
        displayStyle: 'grid'
    });

    tabs({
        tabsParentSelector: '.authorization__list',
        itemsParentSelector: '.authorization__items',
        activeStyle: 'authorization__list-item--active',
        displayStyle: 'flex'
    });

    checkbox({
        checkboxSelector: '.authorization__label',
        activeStyle: 'authorization__label--active'
    })

    burger({
        burgerSelector: '.burger',
        listSelector: '.navigation',
        activeBurgerStyle: 'burger--active',
        activeListStle: 'navigation--active'
    })

    slider({
        sliderSelector: '.slider',
        sliderRowSelector: '.slider__row',
        sliderItemsSelector: '.slider__item',
        sliderDotsSelector: '.slider__dots',
        activeDotsClass: '.slider__dot--active'
    })
    
})